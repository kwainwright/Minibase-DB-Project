<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_13) on Sun Jul 27 05:37:28 EDT 2014 -->
<title>BufMgr</title>
<meta name="date" content="2014-07-27">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="BufMgr";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../index.html?bufmgr/BufMgr.html" target="_top">Frames</a></li>
<li><a href="BufMgr.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">bufmgr</div>
<h2 title="Class BufMgr" class="title">Class BufMgr</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>bufmgr.BufMgr</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../global/GlobalConst.html" title="interface in global">GlobalConst</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">BufMgr</span>
extends java.lang.Object
implements <a href="../global/GlobalConst.html" title="interface in global">GlobalConst</a></pre>
<div class="block"><h3>Minibase Buffer Manager</h3>
 The buffer manager reads disk pages into a main memory page as needed. The
 collection of main memory pages (called frames) used by the buffer manager
 for this purpose is called the buffer pool. This is just an array of Page
 objects. The buffer manager is used by access methods, heap files, and
 relational operators to read, write, allocate, and de-allocate pages.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../global/Page.html" title="class in global">Page</a>[]</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#bufpool">bufpool</a></strong></code>
<div class="block">Actual pool of pages (can be viewed as an array of byte arrays).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected bufmgr.FrameDesc[]</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#frametab">frametab</a></strong></code>
<div class="block">Array of descriptors, each containing the pin count, dirty status, etc.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.util.HashMap&lt;java.lang.Integer,bufmgr.FrameDesc&gt;</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#pagemap">pagemap</a></strong></code>
<div class="block">Maps current page numbers to frames; used for efficient lookups.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected bufmgr.Replacer</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#replacer">replacer</a></strong></code>
<div class="block">The replacement policy to use.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_global.GlobalConst">
<!--   -->
</a>
<h3>Fields inherited from interface&nbsp;global.<a href="../global/GlobalConst.html" title="interface in global">GlobalConst</a></h3>
<code><a href="../global/GlobalConst.html#EMPTY_SLOT">EMPTY_SLOT</a>, <a href="../global/GlobalConst.html#FIRST_PAGEID">FIRST_PAGEID</a>, <a href="../global/GlobalConst.html#INVALID_PAGEID">INVALID_PAGEID</a>, <a href="../global/GlobalConst.html#MAX_COLSIZE">MAX_COLSIZE</a>, <a href="../global/GlobalConst.html#MAX_TUPSIZE">MAX_TUPSIZE</a>, <a href="../global/GlobalConst.html#NAME_MAXLEN">NAME_MAXLEN</a>, <a href="../global/GlobalConst.html#PAGE_SIZE">PAGE_SIZE</a>, <a href="../global/GlobalConst.html#PIN_DISKIO">PIN_DISKIO</a>, <a href="../global/GlobalConst.html#PIN_MEMCPY">PIN_MEMCPY</a>, <a href="../global/GlobalConst.html#UNPIN_CLEAN">UNPIN_CLEAN</a>, <a href="../global/GlobalConst.html#UNPIN_DIRTY">UNPIN_DIRTY</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../bufmgr/BufMgr.html#BufMgr(int)">BufMgr</a></strong>(int&nbsp;numbufs)</code>
<div class="block">Constructs a buffer mamanger with the given settings.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#flushAllPages()">flushAllPages</a></strong>()</code>
<div class="block">Immediately writes all dirty pages in the buffer pool to disk.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#flushPage(global.PageId)">flushPage</a></strong>(<a href="../global/PageId.html" title="class in global">PageId</a>&nbsp;pageno)</code>
<div class="block">Immediately writes a page in the buffer pool to disk, if dirty.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#flushPages(global.PageId)">flushPages</a></strong>(<a href="../global/PageId.html" title="class in global">PageId</a>&nbsp;pageno)</code>
<div class="block">Helper method to flush a dirty page or all dirty pages to disk.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#freePage(global.PageId)">freePage</a></strong>(<a href="../global/PageId.html" title="class in global">PageId</a>&nbsp;pageno)</code>
<div class="block">Deallocates a single page from disk, freeing it from the pool if needed.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#getNumBuffers()">getNumBuffers</a></strong>()</code>
<div class="block">Gets the total number of buffer frames.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#getNumUnpinned()">getNumUnpinned</a></strong>()</code>
<div class="block">Gets the total number of unpinned buffer frames.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../global/PageId.html" title="class in global">PageId</a></code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#newPage(global.Page, int)">newPage</a></strong>(<a href="../global/Page.html" title="class in global">Page</a>&nbsp;firstpg,
       int&nbsp;run_size)</code>
<div class="block">Allocates a set of new pages, and pins the first one in an appropriate
 frame in the buffer pool.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#pinPage(global.PageId, global.Page, boolean)">pinPage</a></strong>(<a href="../global/PageId.html" title="class in global">PageId</a>&nbsp;pageno,
       <a href="../global/Page.html" title="class in global">Page</a>&nbsp;page,
       boolean&nbsp;skipRead)</code>
<div class="block">Pins a disk page into the buffer pool.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../bufmgr/BufMgr.html#unpinPage(global.PageId, boolean)">unpinPage</a></strong>(<a href="../global/PageId.html" title="class in global">PageId</a>&nbsp;pageno,
         boolean&nbsp;dirty)</code>
<div class="block">Unpins a disk page from the buffer pool, decreasing its pin count.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="bufpool">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bufpool</h4>
<pre>protected&nbsp;<a href="../global/Page.html" title="class in global">Page</a>[] bufpool</pre>
<div class="block">Actual pool of pages (can be viewed as an array of byte arrays).</div>
</li>
</ul>
<a name="frametab">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>frametab</h4>
<pre>protected&nbsp;bufmgr.FrameDesc[] frametab</pre>
<div class="block">Array of descriptors, each containing the pin count, dirty status, etc.</div>
</li>
</ul>
<a name="pagemap">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pagemap</h4>
<pre>protected&nbsp;java.util.HashMap&lt;java.lang.Integer,bufmgr.FrameDesc&gt; pagemap</pre>
<div class="block">Maps current page numbers to frames; used for efficient lookups.</div>
</li>
</ul>
<a name="replacer">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>replacer</h4>
<pre>protected&nbsp;bufmgr.Replacer replacer</pre>
<div class="block">The replacement policy to use.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BufMgr(int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BufMgr</h4>
<pre>public&nbsp;BufMgr(int&nbsp;numbufs)</pre>
<div class="block">Constructs a buffer mamanger with the given settings.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>numbufs</code> - number of buffers in the buffer pool</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="newPage(global.Page, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>newPage</h4>
<pre>public&nbsp;<a href="../global/PageId.html" title="class in global">PageId</a>&nbsp;newPage(<a href="../global/Page.html" title="class in global">Page</a>&nbsp;firstpg,
             int&nbsp;run_size)</pre>
<div class="block">Allocates a set of new pages, and pins the first one in an appropriate
 frame in the buffer pool.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>firstpg</code> - holds the contents of the first page</dd><dd><code>run_size</code> - number of pages to allocate</dd>
<dt><span class="strong">Returns:</span></dt><dd>page id of the first new page</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if PIN_MEMCPY and the page is pinned</dd>
<dd><code>java.lang.IllegalStateException</code> - if all pages are pinned (i.e. pool exceeded)</dd></dl>
</li>
</ul>
<a name="freePage(global.PageId)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>freePage</h4>
<pre>public&nbsp;void&nbsp;freePage(<a href="../global/PageId.html" title="class in global">PageId</a>&nbsp;pageno)</pre>
<div class="block">Deallocates a single page from disk, freeing it from the pool if needed.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pageno</code> - identifies the page to remove</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if the page is pinned</dd></dl>
</li>
</ul>
<a name="pinPage(global.PageId, global.Page, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pinPage</h4>
<pre>public&nbsp;void&nbsp;pinPage(<a href="../global/PageId.html" title="class in global">PageId</a>&nbsp;pageno,
           <a href="../global/Page.html" title="class in global">Page</a>&nbsp;page,
           boolean&nbsp;skipRead)</pre>
<div class="block">Pins a disk page into the buffer pool. If the page is already pinned, this
 simply increments the pin count. Otherwise, this selects another page in
 the pool to replace, flushing it to disk if dirty.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pageno</code> - identifies the page to pin</dd><dd><code>page</code> - holds contents of the page, either an input or output param</dd><dd><code>skipRead</code> - PIN_MEMCPY (replace in pool); PIN_DISKIO (read the page in)</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if PIN_MEMCPY and the page is pinned</dd>
<dd><code>java.lang.IllegalStateException</code> - if all pages are pinned (i.e. pool exceeded)</dd></dl>
</li>
</ul>
<a name="unpinPage(global.PageId, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unpinPage</h4>
<pre>public&nbsp;void&nbsp;unpinPage(<a href="../global/PageId.html" title="class in global">PageId</a>&nbsp;pageno,
             boolean&nbsp;dirty)</pre>
<div class="block">Unpins a disk page from the buffer pool, decreasing its pin count.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pageno</code> - identifies the page to unpin</dd><dd><code>dirty</code> - UNPIN_DIRTY if the page was modified, UNPIN_CLEAN otherrwise</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if the page is not present or not pinned</dd></dl>
</li>
</ul>
<a name="flushPage(global.PageId)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flushPage</h4>
<pre>public&nbsp;void&nbsp;flushPage(<a href="../global/PageId.html" title="class in global">PageId</a>&nbsp;pageno)</pre>
<div class="block">Immediately writes a page in the buffer pool to disk, if dirty.</div>
</li>
</ul>
<a name="flushAllPages()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flushAllPages</h4>
<pre>public&nbsp;void&nbsp;flushAllPages()</pre>
<div class="block">Immediately writes all dirty pages in the buffer pool to disk.</div>
</li>
</ul>
<a name="flushPages(global.PageId)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flushPages</h4>
<pre>protected&nbsp;void&nbsp;flushPages(<a href="../global/PageId.html" title="class in global">PageId</a>&nbsp;pageno)</pre>
<div class="block">Helper method to flush a dirty page or all dirty pages to disk.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pageno</code> - identifies to the page to flush, or null if all pages</dd></dl>
</li>
</ul>
<a name="getNumBuffers()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNumBuffers</h4>
<pre>public&nbsp;int&nbsp;getNumBuffers()</pre>
<div class="block">Gets the total number of buffer frames.</div>
</li>
</ul>
<a name="getNumUnpinned()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getNumUnpinned</h4>
<pre>public&nbsp;int&nbsp;getNumUnpinned()</pre>
<div class="block">Gets the total number of unpinned buffer frames.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../index.html?bufmgr/BufMgr.html" target="_top">Frames</a></li>
<li><a href="BufMgr.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
